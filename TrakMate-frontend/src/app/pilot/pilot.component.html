<app-nav-bar></app-nav-bar>

<section class="page">
  <header class="page__header">
    <div>
      <h1>PiloÈ›ii TrakMate</h1>
      <p class="muted">
        {{ filtered.length }} pilot{{ filtered.length === 1 ? '' : 'i' }} gÄƒsit{{ filtered.length === 1 ? '' : 'i' }}.
      </p>
    </div>

    <div class="toolbar">
      <div class="search">
        <input
          type="text"
          placeholder="CautÄƒ dupÄƒ nume sau prenumeâ€¦"
          [(ngModel)]="q"
          (input)="applyFilters()"
        />
        <span class="kbd">/</span>
      </div>

      <select [(ngModel)]="sortBy" (change)="applyFilters()" class="sel">
        <option value="lastName">SorteazÄƒ: Nume de familie (Aâ€“Z)</option>
        <option value="firstName">SorteazÄƒ: Prenume (Aâ€“Z)</option>
      </select>

      <button class="btn ghost" (click)="clearFilters()" [disabled]="!q">
        Reset filtre
      </button>
    </div>
  </header>

  <div class="empty" *ngIf="!loading && filtered.length === 0">
    <div class="empty__card">
      <h3>Nu am gÄƒsit niciun pilot</h3>
      <p class="muted">ÃncearcÄƒ alt termen de cÄƒutare sau scoate filtrele.</p>
      <button class="btn" (click)="clearFilters()">ReseteazÄƒ filtrele</button>
    </div>
  </div>

  <div class="grid" *ngIf="loading">
    <div class="skeleton" *ngFor="let _ of [0,1,2,3,4,5,6,7]"></div>
  </div>

  <div class="grid" *ngIf="!loading && filtered.length">
    <article class="card" *ngFor="let p of filtered">
      <div class="card__head">
        <h3 class="card__title">{{ p.firstName }} {{ p.lastName }}</h3>
      </div>
      
      <div class="card__meta">
        <!-- Loc pentru metadate suplimentare (ex: Rol) -->
      </div>
      
      <div class="card__actions">
        <button class="btn small" (click)="viewPilotTimes(p)">Vezi Timpi</button>
        
        <!-- NOU: Buton È˜terge (doar Admin) -->
        <button 
          class="btn btn-delete small" 
          *ngIf="isAdminUser" 
          (click)="deletePilot(p.id, p.firstName + ' ' + p.lastName)"
        >
          ğŸ—‘ï¸ È˜terge
        </button>
      </div>
    </article>
  </div>
</section>

<app-footer></app-footer>